define("contextMenu",["jquery","themepunchTools"],function(e,t){return new function(){function a(e){var t=0,a=0;if(!e)var e=window.event;return e.pageX||e.pageY?(t=e.pageX,a=e.pageY):(e.clientX||e.clientY)&&(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:t,y:a}}function s(){l(),c(),n(),o()}function l(){document.addEventListener("contextmenu",function(t){p=S.clickInsideElement(t,"slide_layer"),e(p).hasClass("demo_layer")||(p?(S.setLayerSelected(e(p).data("serial")),t.preventDefault(),O.toggleMenuOn("layer"),b(t)):(p=S.clickInsideElement(t,"bg_context_listener"))?(t.preventDefault(),O.toggleMenuOn("background"),b(t)):(p=S.clickInsideElement(t,"ignorecontextmenu"))?(t.preventDefault(),O.toggleMenuOn(),b(t)):(p=null,O.toggleMenuOff()))})}function c(){e("body").on("click",function(e){var t=S.clickInsideElement(e,A);t?(e.preventDefault(),m(t)):1===(e.which||e.button)&&O.toggleMenuOff()})}function n(){window.onkeyup=function(e){27===e.keyCode&&O.toggleMenuOff()}}function o(){window.onresize=function(e){O.toggleMenuOff()}}function r(e){var t="rs-icon-layerimage_n";switch(e){case"image":t="rs-icon-layerimage_n";break;case"text":t="rs-icon-layerfont_n";break;case"button":t="rs-icon-layerbutton_n";break;case"audio":t="rs-icon-layeraudio_n";break;case"video":t="rs-icon-layervideo_n";break;case"svg":t="rs-icon-layersvg_n";break;case"row":t="rs-icon-layergroup_n";break;case"column":t="rs-icon-layercolumn_n";break;case"group":t="rs-icon-layergroup_n"}return t}function d(t,a){t?e(a).removeClass("ctx-td-s-off"):e(a).addClass("ctx-td-s-off")}function y(){e(".not_in_ctx_bg").hide(),e(".not_in_ctx_layer").show();var t=e("#ctx_list_of_layers");t.html("");for(i in S.arrLayers)if(S.arrLayers.hasOwnProperty(i)){var a=S.arrLayers[i],s=r(a.type);t.append('<li class="ctx-dyn-avl-list-item context-menu__item" data-serial="'+a.serial+'"><div class="ctx_item_inner"><div class="context-menu__link" data-serial="'+a.serial+'" data-action="selectonelayer"><i class="'+s+'"></i><span class="cx-layer-name">'+a.alias+"</span></div></div></li>")}}function _(){var t=S.getLayer(S.selectedLayerSerial),a=t.references.htmlLayer;e(".not_in_ctx_bg").show(),e(".not_in_ctx_layer").hide(),e("#cx-selected-layer-name").html(t.alias),e("#cx-selected-layer-icon").attr("class",r(t.type));var s=e("#cx-selected-layer-visible"),l=e("#cx-selected-layer-locked");z.isLayerVisible(a)?(s.find("i").attr("class","eg-icon-eye-off"),s.find(".cx-layer-name").html("Hide Layer")):(s.find("i").attr("class","eg-icon-eye"),s.find(".cx-layer-name").html("Show Layer")),z.isLayerLocked(a)?(l.find("i").attr("class","eg-icon-lock-open"),l.find(".cx-layer-name").html("Unlock Layer")):(l.find("i").attr("class","eg-icon-lock"),l.find(".cx-layer-name").html("Lock Layer"));var i=e("#ctx_list_of_invisibles"),c=e("#ctx_list_of_layers"),n=!0;i.find(".ctx-dyn-inv-list-item").remove(),c.html("");for(h in S.arrLayers)if(S.arrLayers.hasOwnProperty(h)){var o=r((a=S.arrLayers[h]).type),y=void 0!==a.references&&void 0!==a.references.htmlLayer?a.references.htmlLayer:void 0;if(void 0!==y&&y.hasClass("currently_not_visible")){var _=n?"ctx-m-top-divider":"";n=!1,i.append('<li class="ctx-dyn-inv-list-item '+_+' context-menu__item"><div class="ctx_item_inner"><div class="context-menu__link" data-serial="'+a.serial+'" data-action="showonelayer"><i class="eg-icon-eye"></i><span class="cx-layer-name">'+a.alias+"</span></div></div></li>")}c.append('<li class="ctx-dyn-avl-list-item context-menu__item" data-serial="'+a.serial+'"><div class="ctx_item_inner"><div class="context-menu__link" data-serial="'+a.serial+'" data-action="selectonelayer"><i class="'+o+'"></i><span class="cx-layer-name">'+a.alias+"</span></div></div></li>")}"grid"===t.basealign?(e("#ctx_gridbased").addClass("selected"),e("#ctx_slidebased").removeClass("selected")):(e("#ctx_gridbased").removeClass("selected"),e("#ctx_slidebased").addClass("selected")),d(t["resize-full"],"#ctx_autoresponsive"),d(t.resizeme,"#ctx_childrenresponsive"),d(t.responsive_offset,"#ctx_responsiveoffset"),d(t["visible-desktop"],"#ctx_showhideondesktop"),d(t["visible-notebook"],"#ctx_showhideonnotebook"),d(t["visible-tablet"],"#ctx_showhideontablet"),d(t["visible-mobile"],"#ctx_showhideonmobile"),d(t.autolinebreak,"#ctx_linebreak"),d(t.scaleProportional,"#ctx_keepaspect"),t.displaymode||"block"===t.display?(e("#ctx_displayblock").addClass("selected"),e("#ctx_displayinline").removeClass("selected")):(e("#ctx_displayblock").removeClass("selected"),e("#ctx_displayinline").addClass("selected")),e("#ctx-list-of-layer-links").data("uniqueid",t.unique_id);for(var u=void 0!==t.groupLink?t.groupLink:0,b=e("#ctx-layer-link-type-element-cs"),h=0;h<6;h++)b.removeClass("ctx-layer-link-type-"+h);b.addClass("ctx-layer-link-type-"+u),e(x).data("current_layer",y);var m="column"===S.getObjLayerType(t.p_uid);switch(x.className="context-menu layer_type_"+t.type+" in_column_"+m,e("#ctx-inheritdesktop").show(),e("#ctx-inheritnotebook").show(),e("#ctx-inherittablet").show(),e("#ctx-inheritmobile").show(),S.getLayout()){case"desktop":e("#ctx-inheritdesktop").hide();break;case"notebook":e("#ctx-inheritnotebook").hide();break;case"tablet":e("#ctx-inherittablet").hide();break;case"mobile":e("#ctx-inheritmobile").hide()}}function u(){}function b(t){f=a(t),k=f.x,g=f.y;var s=e("#viewWrapper").offset(),l=e("#divbgholder").offset(),i=e(window).scrollTop();w=x.offsetWidth+4,L=x.offsetHeight+4,C=window.innerWidth;var c=i+(V=window.innerHeight),n=15+k-s.left,o=g-(s.top+25);f.x=k-l.left,f.y=g-l.top,n=n+250>C-s.left?C-(260+s.left):n,o=o+300+s.top>c?c-300-s.top:o,x.style.left=n+"px",x.style.top=o+"px",n>C-(s.left+500)?e("#context-menu-first-ul").addClass("submenustoleft"):e("#context-menu-first-ul").removeClass("submenustoleft"),o+300+s.top+200>c?e("#context-menu-first-ul").addClass("submenustobottom"):e("#context-menu-first-ul").removeClass("submenustobottom")}function h(t){return!e(t).hasClass("ctx-td-s-off")}function m(t){var a,s=!0,l={},i=!1,c=!1;if("delegate"!==t.getAttribute("data-action")){switch(t.getAttribute("data-action")){case"delete":e("#button_delete_layer").click();break;case"duplicate":e("#button_duplicate_layer").click();break;case"showhide":e("#layer-short-toolbar .quick-layer-view").click();break;case"lockunlock":e("#layer-short-toolbar .quick-layer-lock").click();break;case"showalllayer":S.showAllLayers();break;case"showonlycurrent":S.hideAllLayers(S.selectedLayerSerial);break;case"showonelayer":var n=S.getLayer(e(t).data("serial"));z.showLayer(n);break;case"selectonelayer":S.setLayerSelected(e(t).data("serial"));break;case"autoresponsive":s=!1,l["resize-full"]=h(t),l["resize-full"]||(l.resizeme=!1,e("#ctx_childrenresponsive").addClass("ctx-td-s-off")),i=!0;break;case"childrenresponsive":s=!1,l.resizeme=h(t),l.resizeme&&(l["resize-full"]=!0,e("#ctx_autoresponsive").removeClass("ctx-td-s-off")),i=!0;break;case"responsiveoffset":s=!1,l.responsive_offset=h(t),i=!0;break;case"gridbased":s=!1,l.basealign="grid",i=!0;break;case"slidebased":s=!1,l.basealign="slide",i=!0;break;case"nothing":s=!1;break;case"linebreak":s=!1,e("#layer_auto_line_break")[0].checked?e("#layer_auto_line_break")[0].checked=!1:e("#layer_auto_line_break")[0].checked=!0,S.clickOnAutoLineBreak();break;case"displayblock":s=!1,l.displaymode=!0,l.display="block",i=!0,a=e(x).data("current_layer"),c=!0;break;case"displayinline":s=!1,l.displaymode=!1,l.display="inline-block",i=!0,a=e(x).data("current_layer"),c=!0;break;case"advancedcss":e("#advanced-css-layer").click();break;case"resetsize":e("#reset-scale").click();break;case"aspectratio":s=!1,e("#layer_proportional_scale")[0].checked?(e("#layer_proportional_scale")[0].checked=!1,e("#ctx_keepaspect").addClass("ctx-td-s-off")):(e("#layer_proportional_scale")[0].checked=!0,e("#ctx_keepaspect").removeClass("ctx-td-s-off")),l.scaleProportional=e("#layer_proportional_scale")[0].checked,i=!0;break;case"copystyle":s=!1;o=S.getLayer(S.selectedLayerSerial);O.stylecache=UniteAdminRev.duplicateObject(o),UniteAdminRev.showInfo({type:"success",content:"Layer Style Successfull Copied to Clipboard",hidedelay:3});break;case"pastestyle":s=!1;o=S.getLayer(S.selectedLayerSerial);!1===e.isEmptyObject(O.stylecache)?(l.deformation=O.stylecache.deformation,l["deformation-hover"]=O.stylecache["deformation-hover"],l.display=O.stylecache.display,l.displaymode=O.stylecache.displaymode,l.margin=O.stylecache.margin,l.autolinebreak=O.stylecache.autolinebreak,l.padding=O.stylecache.padding,l.whitespace=O.stylecache.whitespace,l.static_styles=O.stylecache.static_styles,l["2d_rotation"]=O.stylecache["2d_rotation"],l["image-size"]=O.stylecache["image-size"],i=!0,a=o.references.htmlLayer,c=!0):UniteAdminRev.showInfo({type:"warning",content:"No Style saved to Clipboard",hidedelay:3});break;case"inheritfromdesktop":case"inheritfromnotebook":case"inheritfromtablet":case"inheritfrommobile":var o=S.getLayer(S.selectedLayerSerial),r=t.getAttribute("data-size");(l={}).static_styles={},l.static_styles.color={},l.static_styles["font-size"]={},l.static_styles["line-height"]={},l.static_styles["font-weight"]={},l.padding={},l.margin={},l.max_height={},l.max_width={},l.scaleX={},l.scaleY={},l["text-align"]={},l.vieo_width={},l.video_height={},l.whitespace={},l.static_styles=S.setVal(l.static_styles,"color",S.getVal(o.static_styles,"color",r),!1),l.static_styles=S.setVal(l.static_styles,"font-size",S.getVal(o.static_styles,"font-size",r),!1),l.static_styles=S.setVal(l.static_styles,"line-height",S.getVal(o.static_styles,"line-height",r),!1),l.static_styles=S.setVal(l.static_styles,"font-weight",S.getVal(o.static_styles,"font-weight",r),!1),l=S.setVal(l,"padding",S.getVal(o,"padding",r),!1),l=S.setVal(l,"margin",S.getVal(o,"margin",r),!1),l=S.setVal(l,"max_height",S.getVal(o,"max_height",r),!1),l=S.setVal(l,"max_width",S.getVal(o,"max_width",r),!1),l=S.setVal(l,"scaleX",S.getVal(o,"scaleX",r),!1),l=S.setVal(l,"scaleY",S.getVal(o,"scaleY",r),!1),l=S.setVal(l,"text-align",S.getVal(o,"text-align",r),!1),l=S.setVal(l,"vieo_width",S.getVal(o,"vieo_width",r),!1),l=S.setVal(l,"video_height",S.getVal(o,"video_height",r),!1),l=S.setVal(l,"whitespace",S.getVal(o,"whitespace",r),!1),i=!0,a=o.references.htmlLayer,c=!0;break;case"showhideondesktop":s=!1,l["visible-desktop"]=h(t),i=!0;break;case"showhideonnotebook":s=!1,l["visible-notebook"]=h(t),i=!0;break;case"showhideontablet":s=!1,l["visible-tablet"]=h(t),i=!0;break;case"showhideonmobile":s=!1,l["visible-mobile"]=h(t),i=!0;break;case"grouplinkchange":s=!1,l.groupLink=t.getAttribute("data-linktype");for(var d=(o=S.getLayer(S.selectedLayerSerial)).references.sorttable.layer.find(".layer-link-type-element-cs").first(),y=e("#ctx-layer-link-type-element-cs"),_=0;_<6;_++)d.removeClass("layer-link-type-"+_),y.removeClass("ctx-layer-link-type-"+_);d.addClass("layer-link-type-"+l.groupLink),y.addClass("ctx-layer-link-type-"+l.groupLink);break;case"addtextlayer":S.nextNewLayerToPosition(f),e("#button_add_layer").click();break;case"addimagelayer":S.nextNewLayerToPosition(f),e("#button_add_layer_image").click();break;case"addaudiolayer":S.nextNewLayerToPosition(f),e("#button_add_layer_audio").click();break;case"addvideolayer":S.nextNewLayerToPosition(f),e("#button_add_layer_video").click();break;case"addbuttonlayer":S.nextNewLayerToPosition(f),e("#button_add_layer_button").click();break;case"addshapelayer":S.nextNewLayerToPosition(f),e("#button_add_layer_shape").click();break;case"addobjectlayer":S.nextNewLayerToPosition(f),e("#button_add_layer_svg").click()}!1===e.isEmptyObject(l)&&S.updateLayer(S.selectedLayerSerial,l),i&&S.updateLayerFormFields(S.selectedLayerSerial),c&&z.rebuildLayerIdle(a),s&&O.toggleMenuOff()}else e(document.getElementById(t.getAttribute("data-delegate"))).click()}var p,f,k,g,x,v,w,L,C,V,O=this,S=new Object,z=new Object,A="context-menu__link",T=0;O.stylecache={},O.init=function(t,a){S=t,z=a,x=document.querySelector("#context-menu"),v=x.querySelectorAll(".context-menu__item"),s(),e(".context-submenu").perfectScrollbar({wheelPropagation:!1,suppressScrollX:!0}),e(".context-submenu").each(function(){e(this).on("mouseenter",function(){e(this).perfectScrollbar("update")})}),e("body").on("mouseenter",".ctx-dyn-avl-list-item",function(){e(".layer_due_list_element_selected").removeClass("layer_due_list_element_selected"),e("#slide_layer_"+e(this).data("serial")).addClass("layer_due_list_element_selected")}),e("body").on("mouseleave",".ctx-dyn-avl-list-item",function(){e(".layer_due_list_element_selected").removeClass("layer_due_list_element_selected")}),e("body").on("click",".ctx-td-switcher",function(){e(this).toggleClass("ctx-td-s-off")}),e("body").on("click",".ctx-td-option-selector",function(){var t=e(this);t.parent().find(".selected").removeClass("selected"),t.addClass("selected")})},O.toggleMenuOn=function(e){t.TweenLite.fromTo(x,.2,{x:10,autoAlpha:0},{x:0,autoAlpha:1,display:"block",ease:t.Power2.easeInOut,delay:.2}),1!==T&&(T=1),"layer"===e?-1!=S.selectedLayerSerial?_():u():"background"===e&&y()},O.toggleMenuOff=function(){0!==T&&(T=0,t.TweenLite.to(x,.2,{y:25,autoAlpha:0}))}}});